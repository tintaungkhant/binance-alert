import*as v from"dotenv";import g from"axios";v.config();var c=class{constructor(e){this.browser=e}async start(){try{let e=await this.browser.newPage();await e.goto("https://p2p.binance.com/trade/all-payments/USDT?fiat=AED"),console.log("Page loaded"),console.log("Selecting currency"),await this.delay(1);let r=this.xpath('//*[@id="__APP"]/div/div[2]/main/div[2]/div[1]/div/div[2]/div[1]/div[2]/div/div/div[1]'),n=await e.$(r);if(!n){console.log("Currency input not found");return}console.log("Hovering over currency input"),await n.hover();let s=this.xpath('//*[@id="__APP"]/div/div[2]/main/div[2]/div[1]/div/div[2]/div[1]/div[2]/div/div/div[2]/div/div/div[2]/div'),a=Array.from(await e.$$(s));if(!a.length){console.log("Currency buttons not found");return}console.log("Clicking currency button");let l=!1;for(let i=0;i<a.length;i++){let t=await e.evaluate(p=>p.textContent,a[i]);if(t=t?t.trim():"",t==="MMK"){await a[i].click(),l=!0;break}}if(!l){console.log("Currency not found");return}console.log("Currency selected"),await this.delay(2),console.log("Selecting first item");let u=this.xpath('//*[@id="__APP"]/div/div[2]/main/div[2]/div[3]/div/div[1]/div[1]/div[2]/div[1]/div/div[1]'),d=await e.$(u);if(!d){console.log("First item not found");return}console.log("Selected first item");let o=await e.evaluate(i=>i.textContent,d);if(o){let i=/[^0-9]/g;o=o.replace(i,"");let t=process.env.BUY_PRICE_THRESHOLD;t=t||"0",console.info("Price: "+o),o<=t&&await this.sendToTelegram(o)}await e.close(),await this.browser.disconnect(),console.log("Browser disconnected")}catch(e){console.log(e)}}xpath(e){return`::-p-xpath(${e})`}async delay(e){return new Promise(r=>{setTimeout(r,e*1e3)})}async sendToTelegram(e){let n=`https://api.telegram.org/bot${process.env.TELEGRAM_BOT_TOKEN}/sendMessage`,s={chat_id:process.env.TELEGRAM_GROUP_ID,text:`Price: ${e}`};await g.get(n,{params:s})}};export{c as default};
//# sourceMappingURL=scraper.js.map
