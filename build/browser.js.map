{
  "version": 3,
  "sources": ["../src/browser.ts"],
  "sourcesContent": ["import puppeteer, { Browser as PuppeteerBrowser } from \"puppeteer\"\nimport { getCache, setCache } from \"./helpers\"\n\nexport default class Browser {\n    browser!: PuppeteerBrowser\n\n    async create() {\n        let max_attempt = 2;\n        let attempts = 0;\n\n        do {\n            try {\n                attempts++;\n\n                let wsEndpoint = await getCache(\"wsEndpoint\");\n\n                if (wsEndpoint) {\n                    this.browser = await puppeteer.connect({\n                        browserWSEndpoint: wsEndpoint\n                    });\n\n                    console.log(\"Browser connected\");\n                    console.log(\"WS Endpoint: \" + wsEndpoint)\n\n                    return this.browser;\n                }\n\n                if (!wsEndpoint) {\n                    const args = [\n                        '--autoplay-policy=user-gesture-required',\n                        '--disable-background-networking',\n                        '--disable-background-timer-throttling',\n                        '--disable-backgrounding-occluded-windows',\n                        '--disable-breakpad',\n                        '--disable-client-side-phishing-detection',\n                        '--disable-component-update',\n                        '--disable-default-apps',\n                        '--disable-dev-shm-usage',\n                        '--disable-domain-reliability',\n                        '--disable-extensions',\n                        '--disable-features=AudioServiceOutOfProcess',\n                        '--disable-hang-monitor',\n                        '--disable-ipc-flooding-protection',\n                        '--disable-notifications',\n                        '--disable-offer-store-unmasked-wallet-cards',\n                        '--disable-popup-blocking',\n                        '--disable-print-preview',\n                        '--disable-prompt-on-repost',\n                        '--disable-renderer-backgrounding',\n                        '--disable-setuid-sandbox',\n                        '--disable-speech-api',\n                        '--disable-sync',\n                        '--hide-scrollbars',\n                        '--ignore-gpu-blacklist',\n                        '--metrics-recording-only',\n                        '--mute-audio',\n                        '--no-default-browser-check',\n                        '--no-first-run',\n                        '--no-pings',\n                        '--no-zygote',\n                        '--password-store=basic',\n                        '--use-gl=swiftshader',\n                        '--use-mock-keychain',\n                        '--no-sandbox',\n                    ];\n\n                    this.browser = await puppeteer.launch({\n                        // userDataDir: \"./user_data\",\n                        headless: true,\n                        args\n                    });\n\n                    wsEndpoint = this.browser.wsEndpoint();\n\n                    await setCache(\"wsEndpoint\", wsEndpoint);\n\n                    console.log(\"Browser created\");\n                    console.log(\"WS Endpoint: \" + wsEndpoint)\n\n                    return this.browser;\n                }\n            } catch (error) {\n                if (attempts === max_attempt) {\n                    console.log(error);\n                    console.log(\"Error at starting browser\");\n                } else {\n                    await setCache(\"wsEndpoint\", \"\");\n                }\n            }\n        } while (attempts < max_attempt);\n    }\n}"],
  "mappings": "AAAA,OAAO,eAAgD;AACvD,SAAS,UAAU,gBAAgB;AAEnC,MAAO,QAAsB;AAAA,EACzB;AAAA,EAEA,MAAM,SAAS;AACX,QAAI,cAAc;AAClB,QAAI,WAAW;AAEf,OAAG;AACC,UAAI;AACA;AAEA,YAAI,aAAa,MAAM,SAAS,YAAY;AAE5C,YAAI,YAAY;AACZ,eAAK,UAAU,MAAM,UAAU,QAAQ;AAAA,YACnC,mBAAmB;AAAA,UACvB,CAAC;AAED,kBAAQ,IAAI,mBAAmB;AAC/B,kBAAQ,IAAI,kBAAkB,UAAU;AAExC,iBAAO,KAAK;AAAA,QAChB;AAEA,YAAI,CAAC,YAAY;AACb,gBAAM,OAAO;AAAA,YACT;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACJ;AAEA,eAAK,UAAU,MAAM,UAAU,OAAO;AAAA;AAAA,YAElC,UAAU;AAAA,YACV;AAAA,UACJ,CAAC;AAED,uBAAa,KAAK,QAAQ,WAAW;AAErC,gBAAM,SAAS,cAAc,UAAU;AAEvC,kBAAQ,IAAI,iBAAiB;AAC7B,kBAAQ,IAAI,kBAAkB,UAAU;AAExC,iBAAO,KAAK;AAAA,QAChB;AAAA,MACJ,SAAS,OAAO;AACZ,YAAI,aAAa,aAAa;AAC1B,kBAAQ,IAAI,KAAK;AACjB,kBAAQ,IAAI,2BAA2B;AAAA,QAC3C,OAAO;AACH,gBAAM,SAAS,cAAc,EAAE;AAAA,QACnC;AAAA,MACJ;AAAA,IACJ,SAAS,WAAW;AAAA,EACxB;AACJ;",
  "names": []
}
